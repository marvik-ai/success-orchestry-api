repos:
  - repo: local
    hooks:
      # --- PRE-COMMIT-HOOKS (Equivalentes locales) ---
      - id: trailing-whitespace
        name: Trim Trailing Whitespace
        entry: trailing-whitespace-fixer
        language: python
        types: [text]
        stages: [pre-commit]

      - id: end-of-file-fixer
        name: Fix End of Files
        entry: end-of-file-fixer
        language: python
        types: [text]
        stages: [pre-commit]

      - id: check-yaml
        name: Check YAML
        entry: check-yaml
        language: python
        types: [yaml]
        stages: [pre-commit]

      - id: check-added-large-files
        name: Check for added large files
        entry: check-added-large-files
        language: python
        args: ['--maxkb=500']
        stages: [pre-commit]

      # --- RUFF (Linter & Formatter) ---
      - id: ruff
        name: ruff
        entry: ruff check --fix
        language: system
        types: [python]
        stages: [pre-commit]

      - id: ruff-format
        name: ruff-format
        entry: ruff format
        language: system
        types: [python]
        stages: [pre-commit]

      # --- MYPY (Type Checking) ---
      - id: mypy
        name: mypy
        entry: mypy .
        language: system
        types: [python]
        pass_filenames: false
        stages: [pre-commit]

      # --- COMMIT MESSAGE VALIDATION ---
      - id: check-commit-msg
        name: Check Commit Message Format
        entry: |
          python3 -c "
          import sys, re;
          msg = open(sys.argv[1]).read().strip();
          pattern = r'^[A-Z]+-[0-9]+\s(feat|fix|chore|docs|refactor|test|style|perf|ci|build|revert)(\([^)]+\))?:\s.+$';
          is_valid = bool(re.match(pattern, msg));
          if not is_valid:
              print('✖ Commit message inválido.\nFormato esperado: TICKET TYPE: descripción\nEjemplo: ABC-123 feat: add login');
          sys.exit(0 if is_valid else 1)
          "
        language: system
        stages: [commit-msg]
